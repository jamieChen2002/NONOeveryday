from notion_client import Client
import os
from dotenv import load_dotenv
import datetime

load_dotenv()

NOTION_API_KEY = os.getenv("NOTION_API_KEY")
DATABASE_ID = os.getenv("NOTION_DATABASE_ID")

FIELD_KEYWORDS = {
    "ç’°å¢ƒ": [
        "å‰è»’", "è¾²å ´", "è‰è“ç”°", "é¦™ç“œç”°", "è‹—æ —", "è¥¿æ¹–", "å¤§æ£š", "æº«å®¤", "é«˜æ¶", "æˆ¶å¤–", "ç”°é–“", "èŒ…ä»”åŸ”", "åœ’å€", "åœ°å¡Š", "åœŸè€•å€", "ç”¢åœ°"
    ],
    "ä½œç‰©ç‹€æ…‹": [
        "æˆç†Ÿ", "é–‹èŠ±", "çµå¯¦", "è‘—æœ", "å¹¼è‹—", "é•·é«˜", "é•·è‘‰", "é•·å‹¢", "ç—…å®³", "é»ƒè‘‰", "æ¯è", "ç¼ºæ°´", "ç™¼èŠ½", "æ–·æ ¹", "ç•°å¸¸", "èç¸®", "æœå¯¦è®Šè‰²", "æœå¯¦è£‚æœ", "çµæœ", "ç”¢æœæœŸ", "å£æœ", "æ¼‚äº®", "å­˜æ´»", "ç™½æ–‘", "ç™½ç²‰ç—…",
        "ç°é»´ç—…", "ç°é»´", "èŠ±èå‡‹", "ç‚­ç–½ç—…", "ç‚­ç–½", "é»‘æ–‘", "è¤è‰²ç—…æ–‘",
        "ç™½è‰²ç²‰æœ«", "ç°è‰²éœ‰ç‹€", "ç™½ç²‰", "è‘‰æ¯", "åœ“å½¢ç—…æ–‘",
        "ç–«ç—…", "æ°´æ¼¬ç‹€", "è…çˆ›", "æ ¹è…ç—…", "æ ¹è…", "æ ¹éƒ¨é»‘åŒ–", "è‘‰æ–‘ç—…", 
        "è‘‰æ–‘", "æ–‘é»", "é»ƒåŒ–", "çŸ®åŒ–", "ç—…æ¯’ç—…", "ç´°èŒæ€§æ–‘é»ç—…",
        "è‘‰ç‰‡åæ²", "è‘‰ç·£ç„¦æ¯", "è‘‰è‰²æš—æ²‰", "è‘‰è„ˆé€æ˜", "è‘‰ç‰‡è®Šåš", "è‘‰ç‰‡æ²æ›²", "è‘‰é¢é»ƒåŒ–", "è‘‰æŸ„é»‘åŒ–", "è‘‰å­çšºç¸®"
    ],
    "æ”¶æˆé‡": [
        "æ”¶æˆ", "æ¡æ”¶", "ç”¢é‡", "ä¸€ç®±", "ä¸€ç±ƒ", "ä¸€ç­", "å¹¾ç®±", "å¹¾æ–¤", "æ²’æ”¶", "è±æ”¶", "æ¶æ”¶", "æ»¿æ»¿", "æˆæœ", "æ²’å¹¾é¡†", "æ”¶æˆé‚„ä¸éŒ¯", "æ”¶ç²"
    ],
    "è¾²äº‹è¡Œå‹•": [
        "æ•´ç†", "é™¤è‰", "æ‰‹æ‹”è‰", "ç‘è—¥", "å™´è—¥", "æ–½è‚¥", "æ’’è‚¥", "çŒæº‰", "æ¾†æ°´", "ç§»è‹—", "è£œè‹—", "æ­æ£š", "ä¿®å‰ª", "ç¶è—¤", "é‹ªè‰", "å¥—è¢‹", "ç¿»åœ°", "ç¿»åœŸ", "ç–èŠ±", "æ”¾èœ‚", "è£œç¶²", "æ•´ç†ç”°å€", "é™¤èŸ²", "æ•èŸ²", "å·¡ç”°", "å™´æœ‰æ©Ÿè³‡æ", "å™´ç‡Ÿé¤ŠåŠ‘", "æ›è¡Œ", "æ•´æ", "æ’­ç¨®", "ä¸‹ç”°", "æ”¶å‰²", "æ•´åœ°", "æ’¿æ‹¾", "æ•´ä¿®", "è¾²è—¥æª¢æ¸¬", "æª¢æ¸¬", "å ±å‘Š"
    ],
    "ç¨®æ¤æ–¹å¼": [
        "æœ‰æ©Ÿ", "ç„¡æ¯’", "ç„¡è¾²è—¥", "è‡ªç„¶è¾²æ³•", "å‹å–„è€•ä½œ", "æ…£è¡Œ", "è¼ªä½œ", "è½‰ä½œ", "æ–°æ³•", "ç’°ä¿", "ç„¡æ¯’æ ½åŸ¹"
    ],
    "æ—¥æœŸ": [
        "ä»Šå¤©", "æ˜¨æ—¥", "ä»Šæ—©", "æ—©ä¸Š", "ä¸‹åˆ", "æ™šä¸Š", "202", "2024", "2025", "ä¸‰æœˆä»½", "å››æœˆä»½", "å¤å¤©", "æ˜¥å¤©", "æœ¬æœˆ", "ä¸Šé€±", "é€™é€±", "å»å¹´", "è¿‘æ—¥", "æ¯å¹´", "æœˆåº•", "å¹´åˆ"
    ],
    "æ°£å€™ç‹€æ³": [
        "å¤§å¤ªé™½", "è‰·é™½", "é™°å¤©", "æ™´å¤©", "å¤©æ°£æ™´æœ—", "å¥½å¤©æ°£", "ä¸‹é›¨", "å¤§é›¨", "å°é›¨", "é›¨åœ", "åˆå¾Œé›·é™£é›¨",
        "æ¿•æ°£é‡", "å¤©æ°£ç†±", "æº«åº¦é«˜", "é«˜æº«", "å¯’æµ", "å†·", "æ¶¼", "éœœé™", "å¯’å†·", "æ¿•å†·", "ä¹¾æ—±", "æ‚¶ç†±", "ç‚ç†±",
        "ä¸‹éœ§", "ä¸‹å°é›¨", "ä¸‹æ¯›æ¯›é›¨", "å¤šé›²", "å¤šé›²æ™‚æ™´", "é™°é›¨", "æš´é›¨", "é™é›¨", "æ™´æ™‚å¤šé›²", "å¿½å†·å¿½ç†±",
        "æ°£å€™", "æ—©æ™šæº«å·®å¤§", "å¤©æ°£è®ŠåŒ–å¤§", "å¤©æ°£ä¸ç©©", "å¤©æ°£è½‰æ¶¼", "æ˜¥å¤©", "å¤å¤©", "ç§‹å¤©", "å†¬å¤©"
    ],
    "å¿ƒæƒ…èˆ‡è§€å¯Ÿ": [
        "å¾ˆç´¯", "è¾›è‹¦", "å……å¯¦", "å¾ˆé–‹å¿ƒ", "æœŸå¾…", "æ»¿æ„", "æ„Ÿè¬", "æ„Ÿæ©", "å¿«æ¨‚", "å¾ˆç…©", "å¹¸ç¦", "ç„¡å¥ˆ", "å¥½éšª", "å¯æƒœ", "åŠªåŠ›", "æœ‰è¶£", "æœ‰æ”¶ç©«", "æ„Ÿå‹•", "ç„¡åŠ›", "æ“”å¿ƒ", "ç–²æ†Š", "è¦ºå¾—", "å¾ˆæœ‰è¶£", "æå¤±æ¯”è¼ƒå¤š", "å …æŒ", "ç°¡å–®", "é›£", "æ²’è¾¦æ³•æŒä¹…", "æƒ³ä¼‘æ¯", "ä¼‘æ¯"
    ],
    "æˆæœ¬ç´€éŒ„": [
        "èŠ±äº†", "è²·è‚¥æ–™", "è²·è³‡æ", "è«‹å·¥", "è«‹äººå¹«å¿™", "åŠ ç­", "èŠ±æˆæœ¬", "å¤šèŠ±", "æ”¯å‡º", "æŠ•å…¥", "å·¥éŒ¢", "è–ªæ°´", "ç§Ÿåœ°", "ææ–™è²»", "æ©Ÿæ¢°è²»", "æ°´è²»", "é›»è²»", "è¾²è—¥è²»", "è‚¥æ–™è²»", "ä¿é¤Š", "æª¢æ¸¬è²»", "å ±å‘Šè²»"
    ],
    "æˆæœ¬å‚™è¨»": [
        "æœ‰é»è²´", "ä¾¿å®œ", "åˆ’ç®—", "é ç®—", "è¿½åŠ ", "æ‰£æ‰", "å‰©ä¸‹", "æ¥µé™", "ppm", "åµæ¸¬æ¥µé™"
    ],
    "éŠ·å”®æ–¹å¼": [
        "å®…é…", "è‡ªå–", "ç¾å ´", "ç¶²è³¼", "åœ˜è³¼", "é€šè·¯", "åˆä½œç¤¾", "å¸‚å ´", "æ‰¹ç™¼", "é›¶å”®", "é è³¼", "è¨‚å–®",
        "LINE", "è‡‰æ›¸ç§è¨Š", "FBè¨‚å–®", "Messenger", "ç²‰å°ˆç§è¨Š", "ç¾¤çµ„è¨‚å–®", "è¦ªå‹è¨‚å–®", "ç¾å ´ç›´é€",
        "è¾²å¤«å¸‚é›†", "å¿«é–ƒå¸‚é›†", "æ”¤è²©", "è·¯é‚Šæ”¤", "è‡¨æ™‚æ¥å–®", "å±•å”®æœƒ", "è¾²æ¥­å±•", "å°åŒ—å¿«é–ƒ", "å¤–é€", "åŒå­¸åœ˜", "è¦ªå‹åœ˜",
        "è¨‚è³¼", "é ç´„", "ä¾†åº—è‡ªå–", "é–€å¸‚å–è²¨", "ç¾å ´ç™¼è²¨", "è‡ªå®¶é…é€", "ç‰©æµ", "é»‘è²“å®…æ€¥ä¾¿", "æ–°ç«¹è²¨é‹",
        "lineè¨‚å–®", "lineç¾¤çµ„", "è‡‰æ›¸ç•™è¨€", "fbç•™è¨€", "ç¾å ´ä¸‹å–®", "ç›´æ¥ä¸‹å–®", "ä¸€ç®±å‡ºè²¨", "å†·è—å®…é…", "å†·å‡å®…é…"
    ],
    "éŠ·å”®åƒ¹æ ¼": [
        "å…ƒ", "ä¸€ç›’", "ä¸€æ–¤", "ä¸€å°æ–¤", "å”®åƒ¹", "åƒ¹æ ¼", "ä¸€ç®±", "å„ªæƒ ", "åŸåƒ¹", "ç‰¹åƒ¹", "åƒ¹æ ¼", "å ±åƒ¹"
    ],
    "æ”¶å…¥æ¦‚ä¼°": [
        "è³£äº†", "æ”¶å…¥", "ç‡Ÿæ”¶", "é€²å¸³", "ç¾é‡‘", "åˆ·å¡", "æ”¶ç¾", "ç¸½é¡", "åˆè¨ˆ"
    ],
    "å‚™è¨»äº‹ä»¶": [
        # è¦ªå­/é«”é©—
        "è¦ªå­", "æ¡è‰è“", "è‰è“é«”é©—", "è¦ªå­æ¡æœ", "è‰è“å°è¾²å¤«", "è‰è“ DIY", "è¦ªå­ DIY", "è¦ªå­æ—…éŠ", "è‰è“è¾²å ´æ´»å‹•", "é«”é©—ç‡Ÿ", "å°è¦½", "åœ˜é«”æ´»å‹•", "è¦ªå­æ¨‚åœ’", "äº’å‹•èª²ç¨‹", "è¾²äº‹é«”é©—", "æ‘˜æœ", "è¾²å ´å°è¦½", 
        # è¨ªå®¢/äº¤æµ/äº‹ä»¶
        "é‡Œé•·ä¾†è¨ª", "è¨ªå®¢", "åƒè§€", "è¾²å‹äº¤æµ", "æ´»å‹•", "æ‹œè¨ª", "åª’é«”", "å±•è¦½", "å®¢äºº", "è¦ªå‹", "æ„å¤–", "ä¿®ç¹•", "æ–°è¨­å‚™", "æ‹›å¾…", "é †ä¾¿", 
        # æª¢æ¸¬/å ±å‘Š/ç‰¹æ®Š
        "è¾²è—¥æª¢æ¸¬", "æª¢æ¸¬", "è¾²è—¥0æª¢å‡º", "å ±å‘Š", "è­‰æ˜", "æ¥µé™", "åµæ¸¬", "åŒ–å­¸è¾²è—¥", "ç„¡è¾²è—¥", "0æª¢å‡º", "åœŸå£¤ç·šèŸ²", "æ°Ÿæ´¾ç‘", "ç”Ÿç”¢å±¥æ­·", "èªªæ˜"
    ],
}

def get_notion_fields():
    url = f"https://api.notion.com/v1/databases/{DATABASE_ID}"
    headers = {
        "Authorization": f"Bearer {NOTION_API_KEY}",
        "Notion-Version": "2022-06-28",
    }
    resp = requests.get(url, headers=headers)
    props = resp.json()["properties"]
    return {k: v["type"] for k, v in props.items()}

import requests

import jieba

def extract_keywords(text: str) -> set:
    return set(jieba.cut(text))

def auto_map_to_fields(text):
    fields = get_notion_fields()
    result = {field: [] for field in fields}
    tokens = extract_keywords(text)
    for field, kw_list in FIELD_KEYWORDS.items():
        # åƒ…å…è¨± FIELD_KEYWORDS["æˆæœ¬ç´€éŒ„"] é—œéµå­—é€²å…¥æˆæœ¬ç´€éŒ„
        if field == "æˆæœ¬ç´€éŒ„":
            result["æˆæœ¬ç´€éŒ„"] = []
            for kw in FIELD_KEYWORDS["æˆæœ¬ç´€éŒ„"]:
                if kw in text:
                    result["æˆæœ¬ç´€éŒ„"].append(kw)
            continue
        for kw in kw_list:
            if kw in text:
                result[field].append(kw)
    # æˆæœ¬å‚™è¨»è‡ªå‹•åŠ ç¸½æˆæœ¬ç´€éŒ„é‡‘é¡
    if "æˆæœ¬å‚™è¨»" in fields:
        import re
        cost_keywords = FIELD_KEYWORDS["æˆæœ¬ç´€éŒ„"]
        total_cost = 0
        for kw in cost_keywords:
            matches = re.findall(fr'{kw}[^\d]*(\d+\.?\d*)\s*å…ƒ', text)
            for m in matches:
                total_cost += float(m)
        if total_cost > 0:
            result["æˆæœ¬å‚™è¨»"] = [str(total_cost)]
    import re
    # è‡ªå‹•æŠ“ã€Œå”®åƒ¹ã€ã€Œåƒ¹æ ¼ã€ã€Œç‰¹åƒ¹ã€ã€ŒåŸåƒ¹ã€ã€Œæ¯ç®±ã€ã€Œä¸€ç®±ã€ã€Œä¸€æ–¤ã€ã€Œä¸€ç›’ã€ã€Œå ±åƒ¹ã€å¾Œçš„æ•¸å­—å…ƒï¼Œå°æ‡‰éŠ·å”®åƒ¹æ ¼æ¬„ä½
    if "éŠ·å”®åƒ¹æ ¼" in fields:
        price_matches = re.findall(r'(å”®åƒ¹|åƒ¹æ ¼|ç‰¹åƒ¹|åŸåƒ¹|æ¯ç®±|ä¸€ç®±|ä¸€æ–¤|ä¸€ç›’|å ±åƒ¹)[^\d]*(\d+\.?\d*)\s*å…ƒ', text)
        if price_matches:
            result["éŠ·å”®åƒ¹æ ¼"].extend([f"{m[1]}å…ƒ" for m in price_matches])
        else:
            # è‹¥æ²’åŒ¹é…åˆ°ä¸Šè¿°æ¨¡å¼ï¼Œä»å˜—è©¦æŠ“æ‰€æœ‰ã€Œæ•¸å­—+å…ƒã€
            price_only = re.findall(r'(\d+\.?\d*)\s*å…ƒ', text)
            if price_only:
                result["éŠ·å”®åƒ¹æ ¼"].extend([f"{x}å…ƒ" for x in price_only])
    # è‡ªå‹•æŠ“ã€Œæ”¶å…¥ã€ã€Œé€²å¸³ã€ã€Œç‡Ÿæ”¶ã€ã€Œåˆè¨ˆã€ã€Œç¸½é¡ã€ã€Œè³£äº†ã€ç­‰å¾Œçš„æ•¸å­—å…ƒï¼Œå°æ‡‰æ”¶å…¥æ¦‚ä¼°æ¬„ä½
    if "æ”¶å…¥æ¦‚ä¼°" in fields:
        income_matches = re.findall(r'(æ”¶å…¥|é€²å¸³|ç‡Ÿæ”¶|åˆè¨ˆ|ç¸½é¡|è³£äº†)[^\d]*(\d+\.?\d*)\s*å…ƒ', text)
        if income_matches:
            result["æ”¶å…¥æ¦‚ä¼°"].extend([f"{m[1]}å…ƒ" for m in income_matches])
        # è£œå……æŠ“ç¾é‡‘ã€åˆ·å¡ã€æ”¶ç¾æè¿°
        cash_matches = re.findall(r'(ç¾é‡‘|åˆ·å¡|æ”¶ç¾)[^\d]*(\d+\.?\d*)\s*å…ƒ', text)
        if cash_matches:
            result["æ”¶å…¥æ¦‚ä¼°"].extend([f"{m[1]}å…ƒ" for m in cash_matches])

    # é¡å¤–åŠ å…¥åˆ†é¡èˆ‡ç•°å¸¸ç‹€æ…‹æ¨™è¨˜
    if "åˆ†é¡" in fields:
        farming_keywords = {
            "æ–½è‚¥": ["è‚¥", "æœ‰æ©Ÿè‚¥", "åŒ–è‚¥"],
            "æ¾†æ°´": ["çŒæº‰", "æ°´", "æ¾†"],
            "é™¤è‰": ["é›œè‰", "å‰²è‰", "é™¤è‰"],
            "æ”¶æˆ": ["æ¡æ”¶", "æ”¶æˆ", "æ‘˜"],
            "æ’­ç¨®": ["æ’­ç¨®", "ç¨®å­", "ç¨®ä¸‹"]
        }
        category = "å…¶ä»–"
        for k, wordlist in farming_keywords.items():
            if any(w in tokens for w in wordlist):
                category = k
                break
        result["åˆ†é¡"] = [category]

    # ç§»é™¤æ‰€æœ‰ "ç•°å¸¸ç¾è±¡" ç›¸é—œæ¬„ä½è™•ç†ï¼Œåƒ…è™•ç† "ç•°å¸¸ç‹€æ…‹"
    if "ç•°å¸¸ç‹€æ…‹" in fields:
        exclusion_phrases = ["ç„¡ç•°å¸¸", "æ²’æœ‰ç•°å¸¸", "çœ‹èµ·ä¾†æ­£å¸¸", "å¾ˆæ­£å¸¸", "ç„¡ç—…èŸ²å®³", "æœªç™¼ç¾ç•°å¸¸", "å°šå¯", "ç‹€æ³ä¸éŒ¯"]
        abnormal_keywords = [
            "ç™½æ–‘", "ç™½ç²‰ç—…", "æ–‘é»", "è‘‰æ–‘", "è‘‰ç—…", "ç°é»´", "ç°é»´ç—…", "ç‚­ç–½", "ç‚­ç–½ç—…",
            "ç™½è‰²ç²‰æœ«", "ç°è‰²éœ‰ç‹€", "ç™½ç²‰", "è‘‰æ¯", "ç–«ç—…", "æ°´æ¼¬ç‹€", "è…çˆ›", "æ ¹è…", 
            "æ ¹éƒ¨é»‘åŒ–", "çŸ®åŒ–", "ç—…æ¯’", "ç—…æ¯’ç—…", "ç´°èŒæ€§æ–‘é»ç—…", "è‘‰ç‰‡åæ²", 
            "è‘‰ç·£ç„¦æ¯", "è‘‰è‰²æš—æ²‰", "è‘‰è„ˆé€æ˜", "è‘‰ç‰‡è®Šåš", "è‘‰ç‰‡æ²æ›²", "è‘‰é¢é»ƒåŒ–", 
            "è‘‰æŸ„é»‘åŒ–", "è‘‰å­çšºç¸®"
        ]
        if any(phrase in text for phrase in exclusion_phrases):
            result["ç•°å¸¸ç‹€æ…‹"] = ["æ­£å¸¸"]
        else:
            detected = []
            for ab in abnormal_keywords:
                if ab in text:
                    detected.append(ab)
            if detected:
                result["ç•°å¸¸ç‹€æ…‹"] = list(set(detected))
            else:
                result["ç•°å¸¸ç‹€æ…‹"] = ["ç•°å¸¸ï¼š" + text]
    # ç”¢ç”Ÿ Notion éœ€è¦çš„æ ¼å¼
    notion_properties = {}
    for field, vals in result.items():
        t = fields[field]
        if not vals:
            continue
        if field == "ç•°å¸¸ç‹€æ…‹":
            # ç›´æ¥å¯«å…¥åŸæ–‡
            notion_properties[field] = {"rich_text": [{"text": {"content": text}}]}
            continue
        value_str = "ã€".join(list(set(vals)))
        if t == "title":
            notion_properties[field] = {"title": [{"text": {"content": value_str}}]}
        elif t == "rich_text":
            notion_properties[field] = {"rich_text": [{"text": {"content": value_str}}]}
        elif t == "number":
            try:
                # ç‰¹åˆ¥è™•ç†é‡‘é¡æ ¼å¼
                nums = [float(re.sub("[^0-9.]", "", s)) for s in vals if re.search(r'\d', s)]
                notion_properties[field] = {"number": nums[0] if nums else 0}
            except:
                notion_properties[field] = {"number": 0}
        elif t == "date":
            pass  # æ—¥æœŸç”±å¾Œé¢ today è‡ªå‹•è£œ
    # å‚™è¨»äº‹ä»¶æ¬„ä½ï¼šè‹¥æœ‰æ­¤æ¬„ä½å‰‡å­˜å…¨æ–‡
    if "å‚™è¨»äº‹ä»¶" in fields:
        notion_properties["å‚™è¨»äº‹ä»¶"] = {"rich_text": [{"text": {"content": text}}]}
    # è‡ªå‹•å¡«ä»Šå¤©æ—¥æœŸ
    if "æ—¥æœŸ" in fields and "æ—¥æœŸ" not in notion_properties:
        import datetime
        notion_properties["æ—¥æœŸ"] = {"date": {"start": datetime.date.today().isoformat()}}
    # æ–°å¢ï¼šé¡¯ç¤ºç•°å¸¸ç‹€æ…‹èˆ‡åˆ†é¡çš„æ¨è«–çµæœ
    print("ğŸ” åˆ¤æ–·ç•°å¸¸ç‹€æ…‹ï¼š", result.get("ç•°å¸¸ç‹€æ…‹"))
    print("ğŸ” è‡ªå‹•åˆ†é¡ï¼š", result.get("åˆ†é¡"))
    print("ğŸ§© mapping å¾Œçš„ notion_propertiesï¼š", notion_properties)
    return notion_properties

def write_to_notion(text):
    """
    è‡ªå‹•æå–è¾²äº‹å…§å®¹ã€mapping å°æ‡‰æ¬„ä½ï¼Œå¯«å…¥ Notion
    """
    print("ğŸ“ å‚³å…¥ write_to_notion() çš„å…§å®¹ï¼š", text)
    # æ–°å¢ï¼šè‹¥ text æ˜¯ dictï¼Œå‰‡æå– "notes" æ¬„ä½ä½œç‚ºæ–‡å­—
    if isinstance(text, dict):
        text = text.get("notes", "")
    notion = Client(auth=NOTION_API_KEY)
    properties = auto_map_to_fields(text)
    print("ğŸ” åˆ¤æ–·ç•°å¸¸ç‹€æ…‹ï¼š", properties.get("ç•°å¸¸ç‹€æ…‹"))
    print("ğŸ” è‡ªå‹•åˆ†é¡ï¼š", properties.get("åˆ†é¡"))
    print("ğŸ” è‡ªå‹• mapping propertiesï¼š", properties)
    try:
        response = notion.pages.create(
            parent={"database_id": DATABASE_ID},
            properties=properties
        )
        print("âœ… å·²æˆåŠŸå¯«å…¥ Notion")
        return response.get("url", "")
    except Exception as e:
        print("âŒ Notion API å‘¼å«å¤±æ•—ï¼ŒéŒ¯èª¤è¨Šæ¯ï¼š", e)
        raise
